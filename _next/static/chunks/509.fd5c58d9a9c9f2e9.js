(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[509],{4712:function(e,n,t){"use strict";t.d(n,{Z:function(){return c}});var r=t(5893),i=(t(7294),t(6886)),o=t(8456);function c(){return(0,r.jsx)(i.ZP,{container:!0,alignItems:"center",justifyContent:"center",style:{marginTop:24,marginBottom:24},children:(0,r.jsx)(o.Z,{size:64,thickness:5})})}},6415:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return M}});var r=t(5893),i=t(7294),o=t(5152),c=t(6886),u=t(5861),a=t(8520),d=t.n(a),s=t(2804),l=t(2681),h=t(2141),f=t(9090),v=t(8764).Buffer;function p(e,n,t,r,i,o,c){try{var u=e[o](c),a=u.value}catch(d){return void t(d)}u.done?n(a):Promise.resolve(a).then(r,i)}function y(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var o=e.apply(n,t);function c(e){p(o,r,i,c,u,"next",e)}function u(e){p(o,r,i,c,u,"throw",e)}c(void 0)}))}}function x(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=[],r=!0,i=!1,o=void 0;try{for(var c,u=e[Symbol.iterator]();!(r=(c=u.next()).done)&&(t.push(c.value),!n||t.length!==n);r=!0);}catch(a){i=!0,o=a}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var w="NZCP:";function b(){return(b=y(d().mark((function e(n,t,r){var i,o,c,u,a,s,h,p,y,b;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&n){e.next=2;break}return e.abrupt("return",null);case 2:if(i=x(String(n).split("/"),3),o=i[0],c=i[1],u=i[2],a="1"===c,o===w&&a){e.next=7;break}return e.abrupt("return",{error:"Invalid token prefix",code:n});case 7:return e.prev=7,s=v.from(f.decode.asBytes(u)),e.next=11,l.sign.verify(s,{key:r});case 11:return h=e.sent,e.next=14,z(h);case 14:if(p=e.sent,y=m(p),b=Date.now(),y.iss===t){e.next=19;break}return e.abrupt("return",{error:"Invalid Issuer",decoded:y});case 19:if(!(1e3*y.nbf>b)){e.next=21;break}return e.abrupt("return",{error:"NBF Invalid",decoded:y});case 21:if(!(1e3*y.exp<b)){e.next=23;break}return e.abrupt("return",{error:"Expired",decoded:y});case 23:return console.log("Decoded",y),e.abrupt("return",y);case 27:return e.prev=27,e.t0=e.catch(7),console.error("Error verifying token",e.t0),e.abrupt("return",{error:e.t0.message,code:n});case 31:case"end":return e.stop()}}),e,null,[[7,27]])})))).apply(this,arguments)}function g(e,n,t){return b.apply(this,arguments)}function k(){return(k=y(d().mark((function e(n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){return h.decodeFirst(n,(function(n,r){return n?t(n):e(r)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){return k.apply(this,arguments)}function m(e){return{iss:e.get(1),nbf:e.get(5),exp:e.get(4),jti:["urn:uuid",e.get(7).toString("hex")].join(""),vc:e.get("vc")}}var j=t(933);function Z(e,n,t,r,i,o,c){try{var u=e[o](c),a=u.value}catch(d){return void t(d)}u.done?n(a):Promise.resolve(a).then(r,i)}var P,S=(0,s.cn)({key:"codeState",default:null}),C=(0,s.nZ)({key:"tokenSelector",get:(P=d().mark((function e(n){var t,r,i,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.get,r=t(S),i=t(j.uZ),o=t(j.i2),e.abrupt("return",g(r,i,o).catch((function(e){return console.error("Error verifying token",e),null})));case 5:case"end":return e.stop()}}),e)})),function(){var e=this,n=arguments;return new Promise((function(t,r){var i=P.apply(e,n);function o(e){Z(i,t,r,o,c,"next",e)}function c(e){Z(i,t,r,o,c,"throw",e)}o(void 0)}))})}),G=t(4712),J=(0,o.default)((function(){return t.e(164).then(t.t.bind(t,7164,23))}),{loadableGenerated:{webpack:function(){return[7164]},modules:["../src/components/pages/IndexPage.js -> react-qr-reader"]},loading:function(){return null},ssr:!1});function M(){return(0,r.jsx)(i.Suspense,{fallback:(0,r.jsx)(G.Z,{}),children:(0,r.jsx)(K,{})})}function K(){var e=(0,s.Zl)(S),n=(0,s.sJ)(C),t=function(){0;return window.innerHeight<window.innerWidth?"user":"environment"}();return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(c.ZP,{container:!0,direction:"column",alignItems:"center",justify:"center",children:[(0,r.jsx)(c.ZP,{item:!0,style:{width:"100%"},children:(0,r.jsx)(J,{facingMode:t,delay:100,onError:function(e){console.error("Permissions error",e),navigator.permissions.query({name:"camera"}).then((function(e){console.log(e.state),"denied"===e.state&&navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then((function(){return window.location.reload()}))})).catch((function(e){console.log("Got error :",e)}))},onScan:function(n){n&&(console.log("Handle scan",n),e(n))},style:{maxWidth:"calc(100vh - 64px - 192px)",width:"100%",margin:"0 auto"}})}),(0,r.jsxs)(c.ZP,{item:!0,children:[n&&n.error&&(0,r.jsx)(O,{token:n}),n&&!n.error&&(0,r.jsx)(I,{token:n})]})]})})}function O(e){var n=e.token;return(0,r.jsx)(c.ZP,{container:!0,direction:"column",style:{marginTop:24},children:(0,r.jsxs)(u.Z,{variant:"h5",color:"error",children:["Error: ",n.error]})})}function I(e){var n,t=e.token,i=((0,j.xz)(),null===t||void 0===t||null===(n=t.vc)||void 0===n?void 0:n.credentialSubject);return(0,r.jsxs)("div",{style:{padding:24},children:[(0,r.jsxs)(c.ZP,{container:!0,children:[(0,r.jsx)(u.Z,{color:"textSecondary",variant:"h5",children:"Given Name:"}),(0,r.jsx)(c.ZP,{item:!0,style:{flexGrow:1}}),(0,r.jsx)(u.Z,{variant:"h5",children:(0,r.jsx)("strong",{children:i.givenName})})]}),(0,r.jsxs)(c.ZP,{container:!0,children:[(0,r.jsx)(u.Z,{color:"textSecondary",variant:"h5",children:"Family Name:"}),(0,r.jsx)(c.ZP,{item:!0,style:{flexGrow:1}}),(0,r.jsx)(u.Z,{variant:"h5",children:(0,r.jsx)("strong",{children:i.familyName})})]}),(0,r.jsxs)(c.ZP,{container:!0,children:[(0,r.jsx)(u.Z,{color:"textSecondary",variant:"h5",children:"DOB:"}),(0,r.jsx)(c.ZP,{item:!0,style:{flexGrow:1}}),(0,r.jsx)(u.Z,{variant:"h5",children:(0,r.jsx)("strong",{children:i.dob})})]})]})}},933:function(e,n,t){"use strict";t.d(n,{uZ:function(){return a},i2:function(){return d},Yh:function(){return s},_5:function(){return l},zt:function(){return h},xz:function(){return f},EC:function(){return p},Y_:function(){return y}});var r=t(2804),i=t(8764).Buffer,o=(0,r.cn)({key:"didState",default:{"@context":"https://w3.org/ns/did/v1",id:"did:web:nzcp.covid19.health.nz",verificationMethod:[{id:"did:web:nzcp.covid19.health.nz#key-1",controller:"did:web:nzcp.covid19.health.nz",type:"JsonWebKey2020",publicKeyJwk:{kty:"EC",crv:"P-256",x:"zRR-XGsCp12Vvbgui4DD6O6cqmhfPuXMhi1OxPl8760",y:"Iv5SU6FuW-TRYh5_GOrJlcV_gpF_GpFQhCOD8LSk3T0"}}],assertionMethod:["did:web:nzcp.covid19.health.nz#key-1"]}}),c=(0,r.nZ)({key:"verificationSelector",get:function(e){return v((0,e.get)(o))}}),u=(0,r.nZ)({key:"verificationIdSelector",get:function(e){return(0,e.get)(c).id}}),a=(0,r.nZ)({key:"verificationControllerSelector",get:function(e){return(0,e.get)(c).controller}}),d=(0,r.nZ)({key:"jwkSelector",get:function(e){var n=(0,e.get)(c).publicKeyJwk,t=n.kty,r=n.crv,o=n.x,u=n.y;return{kty:t,crv:r,x:i.from(o,"base64"),y:i.from(u,"base64")}}}),s=function(){return(0,r.Zl)(o)},l=function(){return v({"@context":"https://w3.org/ns/did/v1",id:"did:web:nzcp.covid19.health.nz",verificationMethod:[{id:"did:web:nzcp.covid19.health.nz#key-1",controller:"did:web:nzcp.covid19.health.nz",type:"JsonWebKey2020",publicKeyJwk:{kty:"EC",crv:"P-256",x:"zRR-XGsCp12Vvbgui4DD6O6cqmhfPuXMhi1OxPl8760",y:"Iv5SU6FuW-TRYh5_GOrJlcV_gpF_GpFQhCOD8LSk3T0"}}],assertionMethod:["did:web:nzcp.covid19.health.nz#key-1"]}).id},h=function(){return v({"@context":["https://w3.org/ns/did/v1","https://w3id.org/security/suites/jws-2020/v1"],id:"did:web:nzcp.identity.health.nz",verificationMethod:[{id:"did:web:nzcp.identity.health.nz#z12Kf7UQ",controller:"did:web:nzcp.identity.health.nz",type:"JsonWebKey2020",publicKeyJwk:{kty:"EC",crv:"P-256",x:"DQCKJusqMsT0u7CjpmhjVGkHln3A3fS-ayeH4Nu52tc",y:"lxgWzsLtVI8fqZmTPPo9nZ-kzGs7w7XO8-rUU68OxmI"}}],assertionMethod:["did:web:nzcp.identity.health.nz#z12Kf7UQ"]}).id},f=function(){return(0,r.sJ)(u)};function v(e){return e.verificationMethod[0]}function p(){return{"@context":"https://w3.org/ns/did/v1",id:"did:web:nzcp.covid19.health.nz",verificationMethod:[{id:"did:web:nzcp.covid19.health.nz#key-1",controller:"did:web:nzcp.covid19.health.nz",type:"JsonWebKey2020",publicKeyJwk:{kty:"EC",crv:"P-256",x:"zRR-XGsCp12Vvbgui4DD6O6cqmhfPuXMhi1OxPl8760",y:"Iv5SU6FuW-TRYh5_GOrJlcV_gpF_GpFQhCOD8LSk3T0"}}],assertionMethod:["did:web:nzcp.covid19.health.nz#key-1"]}}function y(){return{"@context":["https://w3.org/ns/did/v1","https://w3id.org/security/suites/jws-2020/v1"],id:"did:web:nzcp.identity.health.nz",verificationMethod:[{id:"did:web:nzcp.identity.health.nz#z12Kf7UQ",controller:"did:web:nzcp.identity.health.nz",type:"JsonWebKey2020",publicKeyJwk:{kty:"EC",crv:"P-256",x:"DQCKJusqMsT0u7CjpmhjVGkHln3A3fS-ayeH4Nu52tc",y:"lxgWzsLtVI8fqZmTPPo9nZ-kzGs7w7XO8-rUU68OxmI"}}],assertionMethod:["did:web:nzcp.identity.health.nz#z12Kf7UQ"]}}},6601:function(){},9214:function(){},1922:function(){},2363:function(){},2361:function(){},4616:function(){}}]);